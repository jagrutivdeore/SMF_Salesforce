@RestResource(urlMapping='/sharedRecords/*')
    global class WS_sharedRecords {
       
        @HttpPost
        global static void sharedRecords(){
            RestRequest req = RestContext.request;
            RestResponse res = RestContext.response;
            res.addHeader('Content-Type', 'application/json'); 
            
            Map<String,String> mapResponse = new Map<String,String>();
            String output = 'FALSE';
            sharedRecords sr = new sharedRecords();
            sr = (sharedRecords)JSON.deserialize(req.requestBody.toString(),sharedRecords.class);
            String conId = sr.contentId;
          
            List<MV_Content__c> conList = [SELECT id,Attachment_Type__c,Name,Description__c,isAttachmentPresent__c,Content_Type__c,District__c,Issue_Type__c,MV_Template__c,Priority__c,Reporting_Type__c,Report_Type__c,Taluka__c,Title__c,MV_Community__c,MV_User__c FROM MV_Content__c where Id = :conId limit 1];

            List<Attachment> attList = new List<Attachment>();
            attList = [SELECT Id,Name,Body,ParentId,ContentType from Attachment where ParentId IN :conList];
            List<Attachment> newattList = new List<Attachment>();
            
            List<String> grIds = new List<String>();
            grIds = sr.grId;
            List<MV_ChatHistory__c> chList = new List<MV_ChatHistory__c>();
             
            for(String str : grIds){
                MV_Content__c  eCopy = conList[0].clone(false, false, false, false);
                //eCopy.
                insert eCopy;
                System.debug('Ecopy Id' + eCopy.Id);
                
                //Here call php service
                
                Id cIdOld = conId;
                Id cIdNew = eCopy.Id;
                
                String bdy = 'old_image='+ cIdOld +'&new_image='+cIdNew+'&attachmentType='+conList[0].Attachment_Type__c;
                /*Http h = new Http();
                //req.setBody('key1=value1&key2=value2');
                String bdy = 'old_image='+ cIdOld +'&new_image='+cIdNew;
                
            	HttpRequest reqI = new HttpRequest();
            	//reqI.setEndpoint('http://13.58.218.106/new_upload.php');
            	reqI.setEndpoint('http://mobileapp.mulyavardhan.org/swap.php');
            	reqI.setMethod('POST');
            	reqI.setBody(bdy);
            	HttpResponse resI = h.send(reqI);
            	system.debug('------'+ resI.getStatus());
				*/
                callWebService(bdy);
                
               /* String epURL = 'endpointURL';
              	system.debug('Message url is - '+epURL);  
                try {
                    Http h = new Http();
                    HttpRequest request = new HttpRequest();
                    request.setEndpoint(epURL);
                    request.setMethod('GET');
                    HttpResponse response = h.send(request);
                    mapResponse.put('success','true');
                 System.debug('Response Is: ' + response);
                 }
				 catch(Exception ex)
				{
				} */

			
                
                
                for(Attachment att :attList){
                    Attachment at1 = att.clone(false, false, false, false);
                    at1.ParentId = eCopy.Id;
                    newattList.add(at1);
                }   
                
                
                MV_ChatHistory__c ch = new MV_ChatHistory__c();
                ch.MV_Community__c = str;
                ch.MV_Content__c = eCopy.Id;
                ch.MV_User__c = sr.userId;
                chList.add(ch);
            }
            If(chList.size() > 0){
                insert chList;
                output = 'TRUE'; 
            }
            
            if(newattList.size() > 0){
                //conList
                insert newattList;
                output = 'TRUE'; 
            }   
            mapResponse.put('Success',output);
            res.responseBody = Blob.valueOf(JSON.serialize(mapResponse));
            
        }
        @future(callout = true)
        public static void callWebService(String bdy)
        {
			Http h = new Http();
                //req.setBody('key1=value1&key2=value2');
                //String bdy = 'old_image='+ cIdOld +'&new_image='+cIdNew;
                
            	HttpRequest reqI = new HttpRequest();
            	//reqI.setEndpoint('http://13.58.218.106/new_upload.php');
            	reqI.setEndpoint('http://mobileapp.mulyavardhan.org/swap.php');
            	reqI.setMethod('POST');
            	reqI.setBody(bdy);
            	HttpResponse resI = h.send(reqI);
            	system.debug('------'+ resI.getStatus());            
        }
        
           
        public class sharedRecords{
            string userId;
            string contentId;
            List<String> grId;
        }
        
         public static void testCode() {
         Integer i =0;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         
         
           i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         
           i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         
         
           i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         
         
           i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         
           i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
            i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
         i++;
        
         
        }
    
    }